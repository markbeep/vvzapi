FROM astral/uv:python3.13-trixie-slim

WORKDIR /app

COPY uv.lock pyproject.toml .python-version alembic.ini scrapy.cfg ./ 
RUN uv sync --frozen --no-cache

COPY scraper scraper
COPY api api
COPY alembic alembic


CMD uv run alembic upgrade heads && uv run -m scraper.main
